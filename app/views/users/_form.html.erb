<%= stylesheet_link_tag 'form' %>
<%= form_for(user, class:"form" ) do |f| %>
  <% if user.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(user.errors.count, "error") %> prohibited this user from being saved:</h2>

      <ul>
      <% user.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
<div class=enclosure>
  <div class="field">
    <%= f.label :username %>
    <%= f.text_field :username %>
  </div>

  <div class="field">
    <%= f.label :email %>
    <%= f.text_field :email %>
  </div>

  <div class="field">
    <%= f.label :password %>
    <%= f.password_field :password %>

  </div>
  <div class="field">

    <%= f.label :password_confirmation %>
    <%= f.password_field :password_confirmation %>
  </div>

<% if current_user %>
  <% if current_user.role == 2 %>
    <div class="field">
      <%= f.label :role %>
      <%= f.text_field :role %>
    </div>
  <% end %>

  <%= fields_for @user.preference do |p| %>

  <div class="field">
    <%= p.label "Health Label" %><!--- was :healthlabel_ids --->
    <%= p.select :healthlabel_ids , Healthlabel.all.map{|a| [a.name, a.id]}, :include_blank => "Select" %>
  </div>

  <div class="field">
    <%= p.label "Diet Label" %> <!--- was :dietlabel_ids --->
    <%= p.select :dietlabel_ids, Dietlabel.all.map{|a| [a.name, a.id]}, :include_blank => "Select" %>
  </div>
  <%end%>
<% else %>
  <%= fields_for @preference do |p| %>

  <div class="field">
    <%= p.label "Health Label" %> <!--- was :healthlabel_ids --->
    <%= p.select :healthlabel_ids , Healthlabel.all.map{|a| [a.name, a.id]}, :include_blank => "Select" %>
  </div>

  <div class="field">
    <%= p.label "Diet Label" %> <!--- was :dietlabel_ids --->
    <%= p.select :dietlabel_ids, Dietlabel.all.map{|a| [a.name, a.id]}, :include_blank => "Select" %>
  </div>
  <%end%>

<% end %>

  <div class="actions">
    <%= f.submit class: "btn btn-primary"%>
  </div>
</div>
  <%= fields_for @preference do |p| %>

    <div class="field">
      <%= p.label :healthlabel_ids %>
      <%= p.number_field :healthlabel_ids  %>
    </div>

    <div class="field">
      <%= p.label :dietlabel_ids %>
      <%= p.number_field :dietlabel_ids  %>
    </div>

  <% end %>

  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>
